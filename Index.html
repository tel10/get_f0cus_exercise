<!DOCTYPE html>
<html ng-app="example_app">
<head lang="en">
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="utf-8" http-equiv="encoding">
    <title>Example Test Micro-Aplication</title>
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script>
    <link href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet">
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    
    <style>
        table, th, td {
            border: 2px solid #E6E6E6;
        }
        td {
            background:white;
            -o-transition:background 1s ease-in;
            -ms-transition:background 1s ease-in;
            -moz-transition:background 1s ease-in;
            -webkit-transition:background 1s ease-in;
            transition:background 1s ease-in;
        }
        td:hover {background:#7094FF;}
        h5 {
            text-align: center;
        }
    </style>
</head>
    <body ng-controller="RespCtrl">
        <form ng-submit="addChannel()">
            <input type="text" size="30" placeholder="add new channel here" class='form-control' style="width:15%; display: inline-block;" id="YT_id" ng-model="givenChannelId">
            <input class="btn btn-success" type="submit" value="add" id="Submmiter">
        </form>
            <table style="width:100%">
                <tr>
                    <td><h5>channelId </h5></td>
                    <td><h5>channelTitle </h5></td>
                    <td><h5>videoId </h5></td>
                    <td><h5>videoTitle </h5></td>
                    <td><h5>publishedAt </h5></td>
                    <td><h5>viewCount </h5></td>
                    <td><h5>likeCount </h5></td>
                    <td><h5>dislikeCount </h5></td>
                    <td><h5>commentCount </h5></td>
                </tr>
                <tr ng-repeat='response in responses'>
                    <td>{{response.channelId}}</td>
                    <td>{{response.channelTitle}}</td>
                    <td>{{response.videoId}}</td>
                    <td>{{response.videoTitle}}</td>
                    <td>{{response.publishedAt}}</td>
                    <td>{{response.viewCount}}</td>
                    <td>{{response.likeCount}}</td>
                    <td>{{response.dislikeCount}}</td>
                    <td>{{response.commentCount}}</td>
                </tr>
            </table>
    <script>
var ex_app = angular.module("example_app",[]);
ex_app.controller('RespCtrl',function($scope) {
        $scope.addChannel = function () {
            if( validateInput($scope.givenChannelId)){
            $.ajax({
                type: "GET",
                url: "https://demo.getfokus.com:3000/Service/Console/YoutubeChannelStats",
                data: {
                    authKey: 91162629,
                    channelId: $scope.givenChannelId
                },
                dataType: 'json',
                success: function(data, textStatus, xhr) { 
                    console.log("status code:",xhr.status);
                },
                complete: function(xhr, textStatus) { 
                    if (xhr.status === 400)
                    {
                        alert("Empty channel id, please enter valid Id");
                    }
                    else if(xhr.status === 401)
                    {
                        alert("Unauthorized User - Please use valid Authentication Key")
                    }
                    else
                    {
                        console.log("status code:",xhr.status);
                    }
                }
            }).done(function (resp) {
                if (resp) {
                    $scope.responses = resp;
                } else {
                    alert('No result.');
                }
            });
        }
        };
//    }
});

function validateInput(arg){
    if( arg.length >= 10 && arg.length <= 30)
    {   
        var checker = !(/[\\/&.,!@#%^*'":?><$;]/.test(arg));
        console.log(checker);
        if(checker === false)
        {
            alert("inappropriate signs channel ID");
            return false;
        }
        else
        {
            return true;
        }
    }
    else
    {
        alert("Too short or too long channel ID");
        return false;
    }
}
    </script>
    </body>
</html>